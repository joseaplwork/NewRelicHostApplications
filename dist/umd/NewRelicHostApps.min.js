!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.NewRelicHostAppsBundle=e()}(this,function(){"use strict";function t(t){var e=0;if(0===t.length)return e;for(var r=0;r<t.length;r+=1)e=(e<<5)-e+t.charCodeAt(r),e&=e;return e}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}();return function(){function s(t){e(this,s),this.MAX_MOST_SATISFING=25;var r=this.constructor.getHashedApps(t);this.apps=this.constructor.sortAppsByApdex(r)}return r(s,[{key:"_getMostSatisfyingApps",value:function(t){var e=t.length>=this.MAX_MOST_SATISFING?this.MAX_MOST_SATISFING:t.length;return t.slice(0,e)}},{key:"_filterByOccurrence",value:function(t,e){return this.apps.filter(function(r){return r[t].includes(e)})}},{key:"getTopAppsByHost",value:function(t){var e=this._filterByOccurrence("host",t);return this._getMostSatisfyingApps(e)}},{key:"_sortedPush",value:function(t){var e=this.apps;if(!e.length)return this.apps.push(this.constructor.getHashedApp(t)),this.apps;if(e[0].apdex<=t.apdex)return this.apps.unshift(this.constructor.getHashedApp(t)),this.apps;if(e[e.length-1].apdex>=t.apdex)return this.apps.push(this.constructor.getHashedApp(t)),this.apps;for(var r=0;r<e.length;r+=1)if(e[r].apdex<=t.apdex){this.apps.splice(r,0,this.constructor.getHashedApp(t));break}return this.apps}},{key:"addAppToHosts",value:function(t){var e=this._sortedPush(t);return this._getMostSatisfyingApps(e)}},{key:"_removeFromApps",value:function(t){var e=this.apps;if(!e.length)return this.apps;var r=e.length-1;if(e[0].$$id===t||e[r].$$id===t){var s=e[0].$$id===t?0:r;return this.apps.splice(s,1),this.apps}for(var n=0;n<e.length;n+=1)if(e[n].$$id===t){this.apps.splice(n,1);break}return this.apps}},{key:"removeAppFromHosts",value:function(t){var e=this._removeFromApps(t);return this._getMostSatisfyingApps(e)}}],[{key:"getHashedApps",value:function(e){if(!e)return null;for(var r=e,s=0;s<e.length;s+=1)r[s].$$id=t(JSON.stringify(r[s]));return r}},{key:"getHashedApp",value:function(e){return Object.assign({},{$$id:t(JSON.stringify(e))},e)}},{key:"sortAppsByApdex",value:function(t){return t&&t.length?t.sort(function(t,e){return t.apdex===e.apdex?0:t.apdex<e.apdex?1:-1}):[]}}]),s}()});
