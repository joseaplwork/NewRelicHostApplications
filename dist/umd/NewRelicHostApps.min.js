!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.NewRelicHostAppsBundle=e()}(this,function(){"use strict";function t(t){var e=0;if(0===t.length)return e;for(var s=0;s<t.length;s+=1)e=(e<<5)-e+t.charCodeAt(s),e&=e;return e}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),e}}();return function(){function r(t){e(this,r),this.MAX_MOST_SATISFING=25;var s=this.constructor.getHashedApps(t);this.apps=this.constructor.sortAppsByApdex(s),this.hostsList=this.constructor.sortHostsByApps(this.apps)}return s(r,[{key:"_getMaxTopItems",value:function(t,e){var s=e||Math.min(t.length,this.MAX_MOST_SATISFING);return t.slice(0,s)}},{key:"_filterByOccurrence",value:function(t,e){return this.apps.filter(function(s){return s[t].includes(e)})}},{key:"getTopAppsByHost",value:function(t,e){var s=this._filterByOccurrence("host",t);return this._getMaxTopItems(s,e)}},{key:"_sortedPush",value:function(t){var e=this.apps;if(!e.length)return this.apps.push(this.constructor.getHashedApp(t)),this.sortHostsByApps(this.apps),this.apps;if(e[0].apdex<=t.apdex)return this.apps.unshift(this.constructor.getHashedApp(t)),this.sortHostsByApps(this.apps),this.apps;if(e[e.length-1].apdex>=t.apdex)return this.apps.push(this.constructor.getHashedApp(t)),this.apps;for(var s=0;s<e.length;s+=1)if(e[s].apdex<=t.apdex){this.apps.splice(s,0,this.constructor.getHashedApp(t));break}return this.sortHostsByApps(this.apps),this.apps}},{key:"addAppToHosts",value:function(t){var e=this._sortedPush(t);return this._getMaxTopItems(e)}},{key:"_removeFromApps",value:function(t){var e=this.apps;if(!e.length)return this.apps;var s=e.length-1;if(e[0].$$id===t||e[s].$$id===t){var r=e[0].$$id===t?0:s;return this.apps.splice(r,1),this.sortHostsByApps(this.apps),this.apps}for(var n=0;n<e.length;n+=1)if(e[n].$$id===t){this.apps.splice(n,1);break}return this.sortHostsByApps(this.apps),this.apps}},{key:"removeAppFromHosts",value:function(t){var e=this._removeFromApps(t);return this._getMaxTopItems(e)}}],[{key:"getHashedApps",value:function(e){return e?e.map(function(e){return Object.assign({},e,{$$id:t(JSON.stringify(e))})}):null}},{key:"getHashedApp",value:function(e){return Object.assign({},{$$id:t(JSON.stringify(e))},e)}},{key:"sortAppsByApdex",value:function(t){return t&&t.length?t.sort(function(t,e){return e.apdex-t.apdex}):[]}},{key:"sortHostsByApps",value:function(t){return t&&t.length?t.reduce(function(t,e){var s=e.host.slice().filter(function(e){return!t.includes(e)});return t.concat(s)},[]):[]}}]),r}()});
