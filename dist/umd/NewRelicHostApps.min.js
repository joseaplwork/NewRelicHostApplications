!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):t.NewRelicHostAppsBundle=s()}(this,function(){"use strict";function t(t){var s=0;if(0===t.length)return s;for(var e=0;e<t.length;e+=1)s=(s<<5)-s+t.charCodeAt(e),s&=s;return s}function s(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var e=function(){function t(t,s){for(var e=0;e<s.length;e++){var r=s[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(s,e,r){return e&&t(s.prototype,e),r&&t(s,r),s}}();return function(){function r(t){s(this,r),this.MAX_MOST_SATISFING=25;var e=this.constructor.getHashedApps(t);this.apps=this.constructor.sortAppsByApdex(e),this.hostsList=this.constructor.sortHostsByApps(this.apps)}return e(r,[{key:"_getMaxTopItems",value:function(t,s){var e=s||Math.min(t.length,this.MAX_MOST_SATISFING);return t.slice(0,e)}},{key:"_filterByOccurrence",value:function(t,s){return this.apps.filter(function(e){return e[t].includes(s)})}},{key:"_sortedPush",value:function(t){var s=this.apps;if(!s.length)return this.apps.push(this.constructor.getHashedApp(t)),this.sortHostsByApps(this.apps),this.apps;if(s[0].apdex<=t.apdex)return this.apps.unshift(this.constructor.getHashedApp(t)),this.sortHostsByApps(this.apps),this.apps;if(s[s.length-1].apdex>=t.apdex)return this.apps.push(this.constructor.getHashedApp(t)),this.apps;for(var e=0;e<s.length;e+=1)if(s[e].apdex<=t.apdex){this.apps.splice(e,0,this.constructor.getHashedApp(t));break}return this.sortHostsByApps(this.apps),this.apps}},{key:"_removeFromApps",value:function(t){var s=this.apps;if(!s.length)return this.apps;var e=s.length-1;if(s[0].$$id===t||s[e].$$id===t){var r=s[0].$$id===t?0:e;return this.apps.splice(r,1),this.sortHostsByApps(this.apps),this.apps}for(var n=0;n<s.length;n+=1)if(s[n].$$id===t){this.apps.splice(n,1);break}return this.sortHostsByApps(this.apps),this.apps}},{key:"getTopAppsByHost",value:function(t,s){var e=this._filterByOccurrence("host",t);return this._getMaxTopItems(e,s)}},{key:"addAppToHosts",value:function(t){var s=this._sortedPush(t);return this._getMaxTopItems(s)}},{key:"removeAppFromHosts",value:function(t){var s=this._removeFromApps(t);return this._getMaxTopItems(s)}}],[{key:"getHashedApps",value:function(s){return s?s.map(function(s){return Object.assign({},s,{$$id:t(JSON.stringify(s))})}):null}},{key:"getHashedApp",value:function(s){return Object.assign({},{$$id:t(JSON.stringify(s))},s)}},{key:"sortAppsByApdex",value:function(t){return t&&t.length?t.sort(function(t,s){return s.apdex-t.apdex}):[]}},{key:"sortHostsByApps",value:function(t){return t&&t.length?t.reduce(function(t,s){var e=s.host.slice().filter(function(s){return!t.includes(s)});return t.concat(e)},[]):[]}}]),r}()});
